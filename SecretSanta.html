<!DOCTYPE html>
<!-- <script src="SecretSanta.js"></script> -->
<!-- <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.0.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.0.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.0.2/firebase-database.js"></script> -->



<script>

</script>



<div class = header>
  <h1>ENTER YOUR HUMAN EMAIL TO RECIEVE GIFT :)</h1>
    <p> or not up to you</p>
    </div>
    <form id="form" onsubmit="return false;">
    <p style = "position:absolute; top:25%; left:5%;" >Name text box!</p>
    <input style="position:absolute; top:30%; left:5%; width:40%;" type="text" id="userName" />

    <p style = "position:absolute; top:35%; left:5%;" >Email text box!</p>
    <input style="position:absolute; top:40%; left:5%; width:40%;" type="text" id="userEmail" />

    <input style="position:absolute; top:45%; left:5%; width:20%;" type="submit" onclick="getInfo();" />
</form>
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->

<script>
function getInfo() {
    var userEmail = document.getElementById("userEmail").value;
    var userName = document.getElementById("userName").value;


    //checks to see if they most likely put in an email by seeing if it has .com,net,org and an @ symbol
    if(validInput(userName, userEmail) == true){
          writeUserData(userName, userEmail);
          alert("thanks! " + userName + "\n"  + userEmail + " has been added to the super cool secret santa list");
    }
    else{
      alert("dont let it happen again");
    }

}</script>


<script>
function validInput(userName, userEmail){
  var mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
  specialRegex = /[^A-Z a-z0-9]/
  // evaluates to true
  if(specialRegex.test(userName)){
    alert("no special characters pls");
    return false;
  }
  else if(userEmail == ""){
    alert("you forgot your email...");
    return false;
  }
  else if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(userEmail)){
    return true;
  }
  else {
    //to get here, the only option left is an invalid email
    alert("That just is not an email");
    return false;
  }

}
</script>

<script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-storage.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-messaging.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-functions.js"></script>

<script>// Your web app's Firebase configuration
var firebaseConfig = {
  apiKey: "apikey holder",
  authDomain: "secretsanta-1b82f.firebaseapp.com",
  databaseURL: "https://secretsanta-1b82f.firebaseio.com",
  projectId: "secretsanta-1b82f",
  storageBucket: "secretsanta-1b82f.appspot.com",
  messagingSenderId: "942574583786",
  appId: "1:942574583786:web:c715c1468f86fb8da73c93"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);
</script>

<script>


function writeUserData(userName, userEmail){
  var db = firebase.database();
  db.ref('Mav/' + userName).set({
    email: userEmail

  });
//  openStores = db.child("stores").get(user['idToken']).val();
}

//TODO: WRITE ANOTHER SCRIPT TO READ DATABASE AND SEND OUT LIST OF YOUR SECRET SANTA
</script>
